# Подготовка

По заданию среда, в которой мы будем работать - Python 3.11. Значит, необходимо настроить эту среду на тех ПК, на которых мы будем работать, желательно ещё и сделать эту среду переносимой чтобы не привязываться к одному рабочему месту.

Задача: 
- Запустить среду python-3.11 на любом компе без сложных танцев с бубном.
- По возможности разоворачивать эту среду быстро и на разных ПК.
Методы: 
- Установка brew. Пакетный менеджер brew работает только на unix-системах, стало быть, любой ПК с windows придётся настраивать отдельно.
- Использование виртуальной машины. Виртуализация доступна на любой платформе, виртуальная конфигурация переносима.

Попробовав настроить brew на школьном маке я пришёл к выводу, что работать через него крайне неудобно. Долгая установка, частые ошибки и необходимость постоянного запуска установочного скрипта на каждом новом маке с последующим ожиданием отталкивают.

А вот виртуальная машина с установленным python на текущем этапе кажется мне более предпочтительным вариантом. Именно его я выбрал для выполнения задач ветки питона.

### Шаг 1. Знакомство с Vagrant

Дабы создание виртуальной операционной системы не было сложным, я автоматизировал его при помощи vagrant. Vagrant - система конфигурирования среды виртуализации, позволяющая запускать виртуальные машины при помощи набора скриптов.

Сначала запустим центр приложений и установим vagrant:

![vagrant](media/vagrant/step_00.png)

Затем убедимся, что наш virtualbox сохраняет свои конфигурации в goinfre:

![vagrant](media/vagrant/step_02.png)

Иначе может не хватить памяти на школьном маке. На домашних машинах можно выбирать любой удобный раздел.

Специально под эту задачу я подготовил конфигурацию vagrant на debian с python3.11. Скачаем её в goinfree:

``git clone https://github.com/codesshaman/vagrant_python_debian.git``

Далее нам необходимо скачать образ debian11 с [vagrantup](https://app.vagrantup.com/bento/boxes/debian-11 "vagrantup"):

![vagrant](media/vagrant/step_01.png)

Скачиваем из строки с virtualbox и сохраняем в папку склонированного репозитория под именем debian.

Теперь редактируем Vagrantfile, изменив в нём переменные с выделенным процессором, памятью и ссылкой на гит-репозиторий. На школьных маках выделенные ресурсы можно не менять, а вот на более слабых ПК можно уменьшить количество выделенных ресурсов во избежании подвисаний. Ну а ссылку на свой проект указывать не обязательно, можно склонировать его уже после установки вручную.

Далее надо выполнить последовательно лишь две команды:

``make build`` и ``make``.

Подробнее процесс установки описан в Readme репозитория.

### Шаг 2. Подключение к конфигурации

Чтобы зайти на созданную виртуальную машину достаточно команды ``make connect`` из каталога репозитория или же подключения по ssh из любого терминала:

``ssh vagrant@192.168.58.98``

Если мы указали в Vagrantfile ссылку на репозиторий нашего проекта, мы должны увидеть папку с именем репозитория в корневой директории.

Но подключаться по ssh из терминала неудобно, потому используем плагин remote_SSH чтобы работать непосредственно из VsCode.

Находим в поиске по плагинам "Remote - SSH" и устанавливаем его.

Создаём новое соединение:

![vagrant](media/vagrant/step_03.png)

Вводим следующую команду для подключения:

``ssh vagrant@192.168.58.98``

И добавляем его в конфиг ssh. Теперь, после того как мы обновим список соединений, мы увидим наш локальный сервер и сможем с ним соединиться.

![vagrant](media/vagrant/step_04.png)

Откроем новое соединение в новом окне, а затем выберем в качестве пути к директории наш путь к скачанному репозиторию. Всё, можно работать!

### Шаг 3. Добавляем ключи в gitlab

Штобы спокойно работать с gitlab с виртуальной машины необходимо сгенерировать внутри неё ssh-ключ и добавить в школьный gitlab (или же в личный github если проект делается там).

Для этого создаём удалённое соединение и на виртуальной машине переходим в папку ssh:

``cd ~/.ssh``

Здесь нам необходимо сгенерировать новый ключ:

``ssh-keygen -t rsa``

Несколько раз нажимаем Enter и в результате получаем два файла - публичный и приватный ключи:

```
vagrant@debian-python:~/.ssh$ ls -la
total 20
drwx------ 2 vagrant root    4096 Dec 18 13:40 .
drwxr-xr-x 5 vagrant vagrant 4096 Dec 18 13:26 ..
-rw------- 1 vagrant vagrant  957 Dec 18 12:53 authorized_keys
-rw------- 1 vagrant vagrant 2610 Dec 18 13:40 id_rsa
-rw-r--r-- 1 vagrant vagrant  575 Dec 18 13:40 id_rsa.pub
```

Нам нужно вывести публичный ключ и скопировать его содержимое:

``cat id_rsa.pub``

Затем добавить этот ключ в свой гит.

### Шаг 4. Делаем конфигурацию переносимой

Виртуальную машину с нужной нам версией python так же легко переносить с одного хоста на другой.

Подробную инструкцию о том, как это делать, я составил для проекта inception и с ней можно ознакомиться [здесь](https://github.com/codesshaman/inception/blob/main/03_CLOUD_STORAGE.md).

Теперь у нас есть почти всё, что нужно для разработки. По мере необходимости мы добавим в виртуальную машину так же и графическое окружение. А пока начнём разработку с нашего ядра!